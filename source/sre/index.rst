SRE 概観
===========================================================

.. contents:: 目次
   :depth: 1
   :local:


SREの定義
-----------------------------------------------------------

**SRE : Site Reliability Engineering：サイト信頼性エンジニアリング**

`RedHat: SRE (サイト信頼性エンジニアリング) とは <https://www.redhat.com/ja/topics/devops/what-is-sre>`_


    SRE (Site Reliability Engineering：サイト信頼性エンジニアリング) は、IT 運用におけるソフトウェア・エンジニアリング・アプローチです。
    SRE チームはソフトウェアツールを使用してシステムの管理、問題解決、および運用タスクの自動化を行います。

    SRE は、運用チームが多くの場合手作業で行ってきたタスクを、ソフトウェアと自動化を活用するエンジニアと運用チームに担当させ、ソフトウェアと自動化によって問題を解決し、本番システムを管理します。  

    SRE は、スケーラブルで信頼性の高いソフトウェアシステムを構築する際に効果を発揮します。
    コードを使用して大規模システムの管理を支援するため、数千台や数万台に及ぶマシンを管理するシステム管理者により多くのスケーラビリティと持続性をもたらします。  

    サイト信頼性エンジニアリングのコンセプトは Google エンジニアリングチームから生まれたもので、Ben Treynor Sloss 氏の功績です。 

    SRE は、新機能のリリースと、ユーザーに対する機能の信頼性の確保とのバランスを取るのに役立ちます。

    その中で、標準化と自動化は、SRE モデルの重要な 2 大要素です。サイト信頼性エンジニアは、運用タスクを向上させて自動化する方法を求めています。


手作業で行われている「運用業務」について「標準化」と「自動化」を行うことにより、システムの「信頼性」を高めていく活動。


SERの文化的側面
-----------------------------------------------------------

「DevOpsの一部」としての文化的側面

- 失敗を許容するマインドセット
- 運用チームと開発チーム間の協力体制
- 障害から学ぶ文化


信頼性とはなにか？
-----------------------------------------------------------

システムが、与えられた条件の下で、与えられた期間、故障せずに、要求どおりに遂行できる能力

要求どおりに遂行できる能力とはなにか？
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

- 機能要件を満たしていること
- 非機能要件を満たしていること

    - `IPA:非機能要求グレード <https://www.ipa.go.jp/archive/digital/iot-en-ci/jyouryuu/hikinou/ent03-b.html>`_ を参考に定めると良い


信頼性の評価指標: RASIS
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. csv-table:: 
   :header: "項目名:英", "項目名:日", "内容"
   :widths: 15, 15, 70

   "Reliability", "信頼性", "壊れにくさの指標。平均故障間隔（時間、分）で評価される"
   "Availability", "可用性", "つかえる状態の維持率。稼働率（％）で評価される"
   "Serviceability", "保守性", "メンテナンス・復旧のしやすさ。平均復旧間隔（時間、分）で評価される"
   "Integrity", "保全性", "データの破壊・改ざんの起こりにくさ"
   "Security", "安全性・機密性", "セキュリティの強度"

稼働率（％）
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

- 稼働率（％） = 平均故障間隔 / 総合時間（平均故障間隔 + 平均復旧間隔）

以下を考えていく

- 平均故障時間をいかに長くするか

- 平均復旧間隔をいかに短くするか

    - メンテナンス

        - リリース時メンテナンス時間の短縮
        - システムを止めないで、切り替えることができるか

    - 復旧:

        - 障害発見
        - 原因究明
        - 対策
        - 復旧


信頼性の評価基準
-----------------------------------------------------------

ユーザ視点（ユーザ満足度に強い相関をもつ）に見たときに、システムに期待する遂行能力の目標基準


SLI（Service Level Indicators） : サービスレベル指標
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

- 提供されるサービスレベルの特定の側面（可用性）を測定するもの

- ユーザーの満足度に強い相関をもつ関心事の測定値

    - 要求のレイテンシー
    - エラーレート
    - システムスループット


SLO（Service Level Objectives）: サービスレベル目標
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

SLI をどの程度満たそうかという目標設定

- 100%は目指さない。障害が起こってしまうのは前提とする
- システムの稼働時間 : 年 99.9%を目指す
- レスポンス時間 : 〇〇% のリクエストに対しては、〇〇 msのレスポンスを保証する

※ **SLO は、あくまで内部向けの目標でよい**


エラーバジェット
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

- エラーやサービス停止の **最大許容しきい値** を指す。

    - **SLO** で定めた許容値内であれば、エラーや停止も受け入れる。

- **ある期間のSLOが保たれている場合**：

    - 新規開発や機能拡張など、改善以外の活動に時間を割く。

- **ある期間のSLOが保たれていない場合**：

    - 新規開発を一時停止し、バグ修正や他の信頼性向上のための改善活動を優先する。


Observability : 観測可能性
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

- 外部出力の知識からシステムの内部状態を推測する仕組み


**利用するデータ**

- メトリクス（使用率やトラフィック等のシステムパフォーマンスの数値データ）

    - 数値データの閾値からイベントを検知

- トレース（トランザクションの経路や時間を追跡させるデータ）

    - イベントの流れを追跡させることで問題の特定/対処

- ログ（イベントやエラーを記録したデータ）

    - 実際の履歴から根本原因の調査

`Observability（オブザーバビリティ）とは何か？知っておきたい新しいIT運用の考え方 <https://www.macnica.co.jp/business/security/manufacturers/splunk/blog_20230515.html>`_ 


運用業務
-----------------------------------------------------------

業務運用
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**システム利用者管理**

システム利用に関する作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "システム利用開始", "入社、昇格などでシステムを新規に利用する場合に実施する"
   "システム利用変更", "異動などで店舗など、登録を変更する場合に実施する"
   "システム利用停止（定期）", "人事システムと連携して月初に一度作業を実施する"
   "システム利用変更（申請）", "システム利用停止（定期）以外で利用停止する場合に実施する"
   "緊急申請作業", "緊急申請により、システム利用に関する変更作業を早急に実施する"
   "利用者棚卸し", "定期的に停止漏れがないかをメインに利用者の棚卸しを実施する"

**サポートデスク**

問い合わせ対応・情報発信に関する作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "問い合わせ対応", "サービス利用者からの問い合わせを管理し、一次回答、エスカレーションを行う"
   "情報発信", "定期メンテナンス情報、障害情報、ユーザの利便性向上を目的とした情報発信を行う"
   "FAQの更新", "エスカレーションした問い合わせ回答の中から、汎用的な作業をFAQとして更新する"
   "問い合わせ情報とりまとめ・報告", "問い合わせ総件数、一次対応解決率、平均対応時間、問い合わせ内容の傾向などを集計して報告する"


**PCライフサイクル管理**

PC・周辺機器管理に関する作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "PC貸し出し", "利用者へのPC・周辺機器貸与を実施する"
   "事故時対応", "PC・周辺機器の故障代替機交換などを実施する"
   "PC返却", "利用者からのPC・周辺機器からの返却対応を実施する"
   "棚卸", "定期的に管理台帳との差異がないかをメインに機器の棚卸を実施する"
   "キッティング", "クライアント用PCのセッティング作業"
   "マスター更新", "クライアント用PCのマスタイメージ更新"


基盤運用
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

システムの正常な動作を保証するための技術的な日常業務（パッチ適用、バックアップなど）を基盤運用とする。

**パッチ運用**

パッチ適用作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "定期パッチ適用", "定期的なパッチ適用作業"
   "緊急パッチ適用", "重大な影響を与えるパッチがリリースされた場合に緊急で行うパッチ適用作業"


**ジョブ/スクリプト運用**

ジョブスケジュール管理に関する作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "ジョブスケジュール設定", "ジョブスケジュールの設定"
   "ジョブスケジュール変更", "登録済みジョブスケジュールの変更"
   "登録済みジョブの再実行", "すでに実行登録しているジョブの再実行"
   "登録済みジョブの停止", "ジョブの停止"


**バックアップ/リストア運用**

バックアップ・リストア作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "バックアップスケジュール設定", "バックアップジョブの設定"
   "バックアップスケジュール変更", "登録済みバックアップジョブの変更"
   "依頼によるリストア", "依頼によるリストア作業"
   "依頼によるバックアップ", "登録済みバックアップジョブを手動で実行する"


**監視運用**

監視対応に関する作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "監視対応", "監視アラートを検知して、一時切り分け、エスカレーションを実施する"
   "監視設定 追加・変更・削除", "監視システムのパラメータ変更"


**ログ管理**

監査・ログ管理に関する作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "監査対応", "監査ログの収集、提出"
   "ログのライフサイクル設定", "外部媒体への退避対応"

**運用アカウント管理**

アカウント管理に関する作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "アカウント 追加・変更・削除", "運用担当者の入退に合わせたアカウント情報の管理"
   "アカウント 棚卸し", "定期的に運用アカウント情報の棚卸を行う"
   "パスワード変更", "セキュリティインシデント発生時にリスクが発生したパスワードを変更する"

**保守契約管理**

保守契約・機器故障対応に関する作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "保守契約管理台帳の更新", "保守契約の内容、期間、問い合わせ先などの情報更新"
   "機器故障時対応", "部品発注、受入、現地作業の立ち合い、交換した故障部品の発送など"


運用管理
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

アカウント管理、運用情報統制、教育など、システム運用の体制や仕組みの維持・改善を運用管理とする。

**運用維持管理**

運用管理プロセスに関する作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "サービスレベル管理", "発注者と利用者の間で結ばれているサービスレベルを維持するための運用体制や仕組みを検討する"
   "キャパシティ管理", "システムのキャパシティに関するデータを収集、調査、分析、報告を実施する"
   "可用性管理", "システムの可用性に関する稼働データを収集、調査、分析、報告を実施する"
   "情報セキュリティ管理", "全社で規定されているセキュリティ方針を維持するために運用がすべきことをまとめる"
   "ITサービス継続性管理", "災害時にサービスを継続させるために運用がすべきことをまとめる"
   "運用要員教育", "運用ドキュメントをベースに運用担当者がどこまでシステムを理解しているべきかの基準をまとめ、定期訓練の実施周期などを検討する"

**運用情報統制**

サービス運用管理プロセスに関する作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "インシデント管理", "チケット起票、発生事象の確認、ナレッジ確認、ワークアラウンドの実施、サポートへの問い合わせなどを行う"
   "問題管理", "問題管理表への起票、根本原因の調査、対応方針の検討、対応、対策の実施などを行う"
   "変更管理", "変更要求の起票、変更作業計画の策定、承認などを行う"
   "リリース管理", "リリース計画の作成、承認などを行う"
   "リクエスト対応", "改善要望の受付、要望実現判断などを行う"
   "ナレッジ管理", "ナレッジの収集、選別、活用などを行う"
   "構成管理", "管理対象の追加、更新、削除、棚卸などを行う"

**定期報告**

定期報告に関する作業一覧

.. csv-table:: 
   :header: "項目名", "内容"
   :widths: 20, 80

   "定期報告", "情報収集、報告用資料の作成、開催調整"

